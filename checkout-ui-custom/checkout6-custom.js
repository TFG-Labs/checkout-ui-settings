(()=>{"use strict";var e={176:(e,t,s)=>{function n(){return!("undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&__SENTRY_BROWSER_BUNDLE__)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function i(e,t){return e.require(t)}s.d(t,{l$:()=>i,KV:()=>n}),e=s.hmd(e)},170:(e,t,s)=>{s.d(t,{ph:()=>l,yW:()=>c});var n=s(176),i=s(235);e=s.hmd(e);const r=(0,i.Rf)(),o={nowSeconds:()=>Date.now()/1e3},a=(0,n.KV)()?function(){try{return(0,n.l$)(e,"perf_hooks").performance}catch(e){return}}():function(){const{performance:e}=r;if(e&&e.now)return{now:()=>e.now(),timeOrigin:Date.now()-e.now()}}(),d=void 0===a?o:{nowSeconds:()=>(a.timeOrigin+a.now())/1e3},c=o.nowSeconds.bind(o),l=d.nowSeconds.bind(d);let u;(()=>{const{performance:e}=r;if(!e||!e.now)return void(u="none");const t=36e5,s=e.now(),n=Date.now(),i=e.timeOrigin?Math.abs(e.timeOrigin+s-n):t,o=i<t,a=e.timing&&e.timing.navigationStart,d="number"==typeof a?Math.abs(a+s-n):t;o||d<t?i<=d?(u="timeOrigin",e.timeOrigin):u="navigationStart":u="dateNow"})()},235:(e,t,s)=>{function n(e){return e&&e.Math==Math?e:void 0}s.d(t,{Rf:()=>r,YO:()=>o,n2:()=>i});const i="object"==typeof globalThis&&n(globalThis)||"object"==typeof window&&n(window)||"object"==typeof self&&n(self)||"object"==typeof s.g&&n(s.g)||function(){return this}()||{};function r(){return i}function o(e,t,s){const n=s||i,r=n.__SENTRY__=n.__SENTRY__||{};return r[e]||(r[e]=t())}}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={id:n,loaded:!1,exports:{}};return e[n](r,r.exports,s),r.loaded=!0,r.exports}s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{const e=()=>'\n  <p id="box-pickup-complement" \n  class="input custom-field-complement tfg-custom-addressForm">\n    <label>Mobile number</label>\n    <input \n      id="custom-pickup-complement" \n      class="input-xlarge success" \n      type="tel" \n      name="complement" \n      placeholder="" \n    />\n  </p>',t="#/shipping",n="#/payment",i="search",r="pickup",o="ricafields",a="tvfields",d="pickup",c=window.location.host.includes("bash.com")?"https://store-api.www.bash.com/custom-api/":`${window.location.protocol}//${window.location.host}/custom-api/`;var l=s(235);function u(){const e=l.n2,t=e.crypto||e.msCrypto;if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");const s=t&&t.getRandomValues?()=>t.getRandomValues(new Uint8Array(1))[0]:()=>16*Math.random();return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&s())>>e/4).toString(16)))}var h=s(170);const p=["debug","info","warn","error","log","assert","trace"];function m(e){if(!("console"in l.n2))return e();const t=l.n2.console,s={};p.forEach((e=>{const n=t[e]&&t[e].__sentry_original__;e in t&&n&&(s[e]=t[e],t[e]=n)}));try{return e()}finally{Object.keys(s).forEach((e=>{t[e]=s[e]}))}}function v(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1}};return"undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?p.forEach((s=>{t[s]=(...t)=>{e&&m((()=>{l.n2.console[s](`Sentry Logger [${s}]:`,...t)}))}})):p.forEach((e=>{t[e]=()=>{}})),t}let g;g="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?(0,l.YO)("logger",v):v();var b=s(176);const y="production",f=Object.prototype.toString;function _(e){return function(e,t){return f.call(e)===`[object ${t}]`}(e,"Object")}function w(e){return Boolean(e&&e.then&&"function"==typeof e.then)}var x;!function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"}(x||(x={}));class k{__init(){this._state=x.PENDING}__init2(){this._handlers=[]}constructor(e){k.prototype.__init.call(this),k.prototype.__init2.call(this),k.prototype.__init3.call(this),k.prototype.__init4.call(this),k.prototype.__init5.call(this),k.prototype.__init6.call(this);try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new k(((s,n)=>{this._handlers.push([!1,t=>{if(e)try{s(e(t))}catch(e){n(e)}else s(t)},e=>{if(t)try{s(t(e))}catch(e){n(e)}else n(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new k(((t,s)=>{let n,i;return this.then((t=>{i=!1,n=t,e&&e()}),(t=>{i=!0,n=t,e&&e()})).then((()=>{i?s(n):t(n)}))}))}__init3(){this._resolve=e=>{this._setResult(x.RESOLVED,e)}}__init4(){this._reject=e=>{this._setResult(x.REJECTED,e)}}__init5(){this._setResult=(e,t)=>{this._state===x.PENDING&&(w(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init6(){this._executeHandlers=()=>{if(this._state===x.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===x.RESOLVED&&e[1](this._value),this._state===x.REJECTED&&e[2](this._value),e[0]=!0)}))}}}function S(e){return C(e,new Map)}function C(e,t){if(_(e)){const s=t.get(e);if(void 0!==s)return s;const n={};t.set(e,n);for(const s of Object.keys(e))void 0!==e[s]&&(n[s]=C(e[s],t));return n}if(Array.isArray(e)){const s=t.get(e);if(void 0!==s)return s;const n=[];return t.set(e,n),e.forEach((e=>{n.push(C(e,t))})),n}return e}function E(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||(0,h.ph)(),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:u()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}class F{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={}}static clone(e){const t=new F;return e&&(t._breadcrumbs=[...e._breadcrumbs],t._tags={...e._tags},t._extra={...e._extra},t._contexts={...e._contexts},t._user=e._user,t._level=e._level,t._span=e._span,t._session=e._session,t._transactionName=e._transactionName,t._fingerprint=e._fingerprint,t._eventProcessors=[...e._eventProcessors],t._requestSession=e._requestSession,t._attachments=[...e._attachments],t._sdkProcessingMetadata={...e._sdkProcessingMetadata}),t}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{},this._session&&E(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this.getSpan();return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if("function"==typeof e){const t=e(this);return t instanceof F?t:this}return e instanceof F?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession)):_(e)&&(this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this}addBreadcrumb(e,t){const s="number"==typeof t?t:100;if(s<=0)return this;const n={timestamp:(0,h.yW)(),...e};return this._breadcrumbs=[...this._breadcrumbs,n].slice(-s),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(e,t={}){if(this._extra&&Object.keys(this._extra).length&&(e.extra={...this._extra,...e.extra}),this._tags&&Object.keys(this._tags).length&&(e.tags={...this._tags,...e.tags}),this._user&&Object.keys(this._user).length&&(e.user={...this._user,...e.user}),this._contexts&&Object.keys(this._contexts).length&&(e.contexts={...this._contexts,...e.contexts}),this._level&&(e.level=this._level),this._transactionName&&(e.transaction=this._transactionName),this._span){e.contexts={trace:this._span.getTraceContext(),...e.contexts};const t=this._span.transaction&&this._span.transaction.name;t&&(e.tags={transaction:t,...e.tags})}return this._applyFingerprint(e),e.breadcrumbs=[...e.breadcrumbs||[],...this._breadcrumbs],e.breadcrumbs=e.breadcrumbs.length>0?e.breadcrumbs:void 0,e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...this._sdkProcessingMetadata},this._notifyEventProcessors([...(0,l.YO)("globalEventProcessors",(()=>[])),...this._eventProcessors],e,t)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}_notifyEventProcessors(e,t,s,n=0){return new k(((i,r)=>{const o=e[n];if(null===t||"function"!=typeof o)i(t);else{const a=o({...t},s);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&o.id&&null===a&&g.log(`Event processor "${o.id}" dropped event`),w(a)?a.then((t=>this._notifyEventProcessors(e,t,s,n+1).then(i))).then(null,r):this._notifyEventProcessors(e,a,s,n+1).then(i).then(null,r)}}))}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}_applyFingerprint(e){var t;e.fingerprint=e.fingerprint?(t=e.fingerprint,Array.isArray(t)?t:[t]):[],this._fingerprint&&(e.fingerprint=e.fingerprint.concat(this._fingerprint)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}}const N=100;class T{constructor(e,t=new F,s=4){this._version=s,this._stack=[{scope:t}],e&&this.bindClient(e)}isOlderThan(e){return this._version<e}bindClient(e){this.getStackTop().client=e,e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=F.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return!(this.getStack().length<=1||!this.getStack().pop())}withScope(e){const t=this.pushScope();try{e(t)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,t){const s=this._lastEventId=t&&t.event_id?t.event_id:u(),n=new Error("Sentry syntheticException");return this._withClient(((i,r)=>{i.captureException(e,{originalException:e,syntheticException:n,...t,event_id:s},r)})),s}captureMessage(e,t,s){const n=this._lastEventId=s&&s.event_id?s.event_id:u(),i=new Error(e);return this._withClient(((r,o)=>{r.captureMessage(e,t,{originalException:e,syntheticException:i,...s,event_id:n},o)})),n}captureEvent(e,t){const s=t&&t.event_id?t.event_id:u();return e.type||(this._lastEventId=s),this._withClient(((n,i)=>{n.captureEvent(e,{...t,event_id:s},i)})),s}lastEventId(){return this._lastEventId}addBreadcrumb(e,t){const{scope:s,client:n}=this.getStackTop();if(!n)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:r=N}=n.getOptions&&n.getOptions()||{};if(r<=0)return;const o={timestamp:(0,h.yW)(),...e},a=i?m((()=>i(o,t))):o;null!==a&&(n.emit&&n.emit("beforeAddBreadcrumb",a,t),s.addBreadcrumb(a,r))}setUser(e){this.getScope().setUser(e)}setTags(e){this.getScope().setTags(e)}setExtras(e){this.getScope().setExtras(e)}setTag(e,t){this.getScope().setTag(e,t)}setExtra(e,t){this.getScope().setExtra(e,t)}setContext(e,t){this.getScope().setContext(e,t)}configureScope(e){const{scope:t,client:s}=this.getStackTop();s&&e(t)}run(e){const t=D(this);try{e(this)}finally{D(t)}}getIntegration(e){const t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(t){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&g.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,t){return this._callExtensionMethod("startTransaction",e,t)}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const e=this.getStackTop().scope,t=e.getSession();t&&function(e,t){let s={};"ok"===e.status&&(s={status:"exited"}),E(e,s)}(t),this._sendSessionUpdate(),e.setSession()}startSession(e){const{scope:t,client:s}=this.getStackTop(),{release:n,environment:i=y}=s&&s.getOptions()||{},{userAgent:r}=l.n2.navigator||{},o=function(e){const t=(0,h.ph)(),s={sid:u(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return S({sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}(s)};return e&&E(s,e),s}({release:n,environment:i,user:t.getUser(),...r&&{userAgent:r},...e}),a=t.getSession&&t.getSession();return a&&"ok"===a.status&&E(a,{status:"exited"}),this.endSession(),t.setSession(o),o}shouldSendDefaultPii(){const e=this.getClient(),t=e&&e.getOptions();return Boolean(t&&t.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:t}=this.getStackTop();if(!e)return;const s=e.getSession();s&&t&&t.captureSession&&t.captureSession(s)}_withClient(e){const{scope:t,client:s}=this.getStackTop();s&&e(s,t)}_callExtensionMethod(e,...t){const s=I().__SENTRY__;if(s&&s.extensions&&"function"==typeof s.extensions[e])return s.extensions[e].apply(this,t);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&g.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function I(){return l.n2.__SENTRY__=l.n2.__SENTRY__||{extensions:{},hub:void 0},l.n2}function D(e){const t=I(),s=R(t);return B(t,e),s}function A(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function R(e){return(0,l.YO)("hub",(()=>new T),e)}function B(e,t){return!!e&&((e.__SENTRY__=e.__SENTRY__||{}).hub=t,!0)}const P=(e,t=!0)=>(e=e.replace(/[^0-9+*#]+/g,"").trim()).length>=6&&t?[e.slice(0,3),e.slice(3,6),e.slice(6)].join(" "):e.length>=3&&t?[e.slice(0,3),e.slice(3)].join(" "):e,O=({preferred:e,type:t="profile",fields:s})=>"collect"===t?e||s?.phone||document?.getElementById("client-phone")?.value||window.vtexjs.checkout.orderForm?.clientProfileData?.phone||"":e||window.vtexjs.checkout.orderForm?.clientProfileData?.phone||document?.getElementById("client-phone")?.value||"",j=e=>{if(!e)return"";let t=e.replace(/\s/g,"");return 9===t.length&&"0"!==t[0]&&(t=`0${t}`),t},L=e=>{var t;console.error("ERROR",e),t=e,function(){const e=I();return A(e)&&!R(e).isOlderThan(4)||B(e,new T),(0,b.KV)()?function(e){try{const t=I().__SENTRY__,s=t&&t.extensions&&t.extensions.domain&&t.extensions.domain.active;if(!s)return R(e);if(!A(s)||R(s).isOlderThan(4)){const t=R(e).getStackTop();B(s,new T(t.client,F.clone(t.scope)))}return R(s)}catch(t){return R(e)}}(e):R(e)}().captureException(t,{captureContext:undefined})},M=({cookie:e,cache:t,json:s})=>{const n=new Headers;return e&&n.append("Cookie",document?.cookie),t&&n.append("Cache-Control","no-cache"),s&&n.append("Content-type","application/json"),n},q=e=>{const t=["938942995"],s=["24833302"],n=[];let i=!1,r=!1,o=!1,a=0,d=!1,c=!1;return e.forEach((e=>{const d=e.productCategoryIds.split("/");n.push(d),d.forEach((e=>{e&&(t.includes(e)?i=!0:s.includes(e)&&(r=!0))})),"FURNITURE"===e.modalType&&(o=!0,a+=1)})),c=a===e.length,d=e.length>1&&o&&!c,{hasFurniture:o,hasSimCards:r,hasTVs:i,hasFurnitureMixed:d,hasFurnitureOnly:c,categories:n}},V=()=>{$(".shimmer").removeClass("shimmer")},U=({focus:e=!1})=>{$(".bash--textfield-businessName").removeClass("optional").slideDown((()=>{$("#bash--input-businessName").attr("required","required"),!$("#bash--input-businessName").val()&&e&&$("#bash--input-businessName")?.focus()}))},W=()=>{$(".bash--textfield-businessName").addClass("optional").slideUp(),$("#bash--input-businessName").removeAttr("required")},Y=()=>{const e=Array.from($("form.form-step.box-edit > :invalid, .error"));e.sort(((e,t)=>e.getBoundingClientRect().top-t.getBoundingClientRect().top)),e?.[0]?.scrollIntoView({block:"center",behavior:"smooth"})},G=({name:e,options:t=[]})=>`\n  \n  <div class="bash--radio-options">\n  ${t.map((({value:t,label:s,checked:n=!1,disabled:i=!1})=>`\n      <label class="bash--radio-option" id="radio-label-${e}-${t}">\n        <input type="radio" \n          ${n?"checked='checked'":""} \n          ${i?"disabled='disabled'":""} \n          value="${t??""}" \n          name="${e}" \n          id="radio-${e}-${t}"\n        />\n          <span class="radio-icon"></span> \n          ${s?`<span class="radio-label">${s}</span>`:""}\n      </label>\n    `)).join("")}\n   \n  </div>\n  `,Z=(e,t)=>JSON.stringify({street:e.street,neighborhood:e.neighborhood,city:e.city,postalCode:e.postalCode})===JSON.stringify({street:t.street,neighborhood:t.neighborhood,city:t.city,postalCode:t.postalCode}),J=e=>{if(!e)return"";const{businessName:t,number:s,street:n,neighborhood:i,postalCode:r,city:o,receiverName:a,addressName:d,complement:c,receiverPhone:l}=e,u=[`${t?`${t}, `:""} ${s?`${s.trim()} `:""}${n}`,i??o,r].join(", ").trim(),h=[a,(p=j(l||c),[p.slice(0,3),p.slice(3,6),p.slice(6)].join(" "))].join(" - ");var p;const m=window?.vtexjs?.checkout?.orderForm?.shippingData?.address;return`\n<label id="address-${d}" class="bash--address-listing" data-address="${encodeURIComponent(JSON.stringify(e))}">\n  <div class="address-radio">\n  ${G({name:"selected-address",options:[{checked:Z(e,m),value:d}]})}\n  </div>\n  <div class="address-text">\n    <div>${u}</div>    \n    <div>${h}</div>  \n  </div>\n  <div class="address-edit">\n    <a href="#" data-view="address-edit" data-content="address-${d}">\n      Edit\n    </a>\n  </div>\n</label>\n`},H=new class{constructor(){this.indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB||window.shimIndexedDB,this.checkoutDB=indexedDB.open("checkoutDB",1.2),this.checkoutDB.onerror=e=>{throw console.error("CheckoutDB Error",{event:e}),new Error("Could not load checkoutDB")},this.checkoutDB.onupgradeneeded=()=>{const e=this.checkoutDB.result.createObjectStore("addresses",{keyPath:"addressName"});e.createIndex("address_street",["street"],{unique:!1}),e.createIndex("address_addressName",["addressName"],{unique:!0}),e.createIndex("address_street_suburb_city_postal",["street","neighborhood","city","postalCode"],{unique:!0})},this.checkoutDB.onsuccess=()=>{const e=this.checkoutDB.result.transaction("addresses","readwrite");this.addresses=e.objectStore("addresses"),e.oncomplete=()=>{}}}store(){return this.checkoutDB.result.transaction("addresses","readwrite").objectStore("addresses")}loadAddresses(e){const t=e.map((e=>this.addOrUpdateAddress(e)));return Promise.all(t).then((e=>e))}addOrUpdateAddress(e){const t=this;return new Promise(((s,n)=>{const i=t.store().put(e);i.onsuccess=()=>{s({success:!0,addressId:i.result})},i.onerror=e=>{n(new Error({sucess:!1,error:e?.target?.error}))}}))}getAddresses(){const e=this;return new Promise((t=>{const s=e.store().getAll();s.onsuccess=()=>t(s.result),s.onerror=()=>{console.error("Something wrong with getAddresses ? ..."),t([])}}))}getAddress(e){const t=this;return new Promise((s=>{const n=t.store().get(e);n.onsuccess=()=>s(n.result),n.onerror=()=>{console.error("Something wrong with getAddress ? ..."),s([])}}))}deleteAddress(e){const t=this.addresses.delete(e);t.onsuccess=()=>t.result}clearData(){const e=this;return new Promise((t=>{const s=e.store().clear();s.onsuccess=()=>t(s.result),s.onerror=()=>{console.error("Something wrong with clearData ? ..."),t([])}}))}},K=e=>{let t=$(`#address-${e.addressName}`);t.length?(t.after(J(e)),t.remove(),t=null):$("#bash-address-list").append(J(e)),$('input[type="radio"][name="selected-address"]:checked').attr("checked",!1),$(`input[type="radio"][name="selected-address"][value="${e.addressName}"]`).attr("checked",!0)},z=async e=>{if(!e.addressName){const t=e.street.replace(/[^a-zA-Z0-9]/g," ").trim().replace(/\s/g,"-").toLowerCase();e.addressName=`${Date.now()}-${t}`.substring(0,50)}e.addressId||(e.addressId=e.addressName),H.addOrUpdateAddress(e).then((()=>K(e))),(async e=>{let t;const{email:s}=window.vtexjs.checkout.orderForm.clientProfileData;if(!e)return Promise.reject(new Error("No address provided."));const n=e.addressName?await(async(e,t)=>{let s={};const n={headers:M({cookie:!0,cache:!0,json:!1}),credentials:"include"},i=await fetch(`${c}masterdata/addresses/?_fields=id&_where=addressName=${e}&timestamp=${Date.now()}`,n).then((e=>e.json())).catch((e=>L(`GET_ADDRESS_ERROR: ${e?.message}`)));return i&&!i.error&&i.data&&i.data.length>0&&([s]=i.data),s})(e.addressName):{};t=n?.id?`${c}masterdata/address/${n.id}`:`${c}masterdata/addresses`;const i={userId:s,...e};n.id||(i.addressName=e.addressId||`address-${Date.now()}`);const r={method:"PATCH",headers:M({cookie:!0,cache:!0,json:!0}),body:JSON.stringify(i),credentials:"include"};await fetch(t,r).then((e=>204!==e.status?e.json():e)).then((e=>e)).catch((e=>L(`SAVE_ADDRESS_ERROR: ${e?.message}`)))})(e)},Q=async e=>H.getAddress(e),X=async()=>H.clearData(),ee=async(e,t,s=!1)=>{const{orderFormId:n}=window.vtexjs.checkout.orderForm,i=`/api/checkout/pub/orderForm/${n}/customData/${e}`,r=JSON.stringify({...t,...s&&{sameAddress:new Boolean(t.sameAddress)}});return fetch(i,{method:"PUT",headers:{"Content-Type":"application/json"},body:r})},te=e=>{const t=window?.vtexjs?.checkout?.orderForm?.customData;let s={};return t&&t.customApps&&t.customApps.length>0&&t.customApps.forEach((t=>{t.id===e&&(s=t.fields)})),s},se=["receiverName","street","neighborhood","state","city","country","postalCode"],ne=["idOrPassport","sameAddress","fullName","streetAddress","suburb","city","postalCode","province"],ie=["tvID"],re=["residential","inStore","commercial","giftRegistry","pickup","search"],oe=()=>{document.querySelector(".bash--delivery-container").classList.add("shimmer")},ae=()=>{document.querySelector(".delivery-group-content")?.classList?.add("shimmer"),document.querySelector(".vtex-omnishipping-1-x-ask")?.classList?.add("shimmer")},de=e=>{switch(e){case"Select":return"";case"Western Cape":return"WC";case"Easter Cape":return"EC";case"Gauteng":return"GP";case"KwaZulu-Natal":case"KwaZulu Natal":return"KZN";case"Northern Cape":return"NC";case"Limpopo":return"LP";case"Mpumalanga":return"MP";case"North West":return"NW";case"Freestate":case"Free State":return"FS";default:return e}},ce=({preferred:e,type:t="delivery"})=>{const s=window?.vtexjs?.checkout?.orderForm?.clientProfileData?.firstName,n=window?.vtexjs?.checkout?.orderForm?.clientProfileData?.lastName,i=window?.vtexjs?.checkout?.orderForm?.shippingData?.address?.receiverName,r=`${s??""} ${n??""}`.trim();return"collect"===t?e||i||r||"":e||document.getElementById("client-first-name")?.value||r||""},le=e=>{const{number:t,street:s,addressType:n,businessName:i,companyBuilding:o,neighborhood:a,postalCode:d,state:c,city:l,receiverName:u,receiverPhone:h,complement:p,id:m,addressId:v,addressName:g,geoCoordinate:b}=e;let y,f;document.getElementById("bash--address-form").reset(),W();try{[y,f]=JSON.parse(JSON.stringify(b))}catch(t){console.warn("Could not parse geo coords",{address:e,geoCoordinate:b})}u&&(document.getElementById("bash--input-receiverName").value=u??""),p&&(document.getElementById("bash--input-complement").value=p??""),(m||v)&&(document.getElementById("bash--input-addressId").value=m||v),g&&(document.getElementById("bash--input-addressName").value=g);const _=`${t?`${t} `:""}${s}`.replace(`, ${o}`,"");"commercial"===n&&($("#radio-addressType-business").click(),U({focus:!1})),i&&(document.getElementById("bash--input-businessName").value=i),document.getElementById("bash--input-number").value="",document.getElementById("bash--input-street").value=_||"",document.getElementById("bash--input-companyBuilding").value=o||"",document.getElementById("bash--input-neighborhood").value=a||"",document.getElementById("bash--input-city").value=l||"",document.getElementById("bash--input-postalCode").value=d||"",document.getElementById("bash--input-state").value=de(c),document.getElementById("bash--input-lat").value=y||"",document.getElementById("bash--input-lng").value=f||"";const w=te(r);u&&(document.getElementById("bash--input-receiverName").value=u??""),p&&(document.getElementById("bash--input-complement").value=p??""),document.getElementById("bash--input-receiverPhone").value=O({preferred:h,type:"delivery",fields:w}),$(":invalid").trigger("change")},ue=e=>{setTimeout((()=>{const t=document.querySelectorAll(".pac-container"),s=document.querySelectorAll(".pac-container[style*='display: none']");t?.length===s?.length&&e.target?.value?.length>3?$("#address-search-field-container:not(.no-results)").addClass("no-results"):$("#address-search-field-container.no-results").removeClass("no-results")}),250)},he=(e,t,s="",n=!1)=>{if(e){for(let i=0;i<t.length;i++){const r=`bash--input-${s}${t[i]}`;!document.getElementById(r)||!e[t[i]]&&!n||document.getElementById(r).value&&!n||(document.getElementById(r).value=e[t[i]])}$(":invalid").trigger("change")}},pe=()=>{const{address:e}=window.vtexjs.checkout.orderForm.shippingData;if(document.getElementById("bash--input-rica_streetAddress")?.value||!e)return;e.fullName=ce({type:"delivery"}),e.streetAddress=e.street,e.suburb=e.neighborhood,e.province=e.state,he(e,ne,"rica_");const t=te(o);t.streetAddress&&he(t,ne,"rica_",!0)},me=(e,t=!0)=>{const{items:s}=window.vtexjs.checkout.orderForm,{hasTVs:n,hasSimCards:i}=q(s);let r=[];const o=[];r=[...se],n&&t&&(r=[...r,...ie]),i&&t&&(r=[...r,...ne]);for(let t=0;t<r.length;t++)e[r[t]]||o.push(r[t]);return{isValid:!o.length,invalidFields:o}},ve=()=>{const{items:e}=window.vtexjs.checkout.orderForm,{hasTVs:t,hasSimCards:s,hasFurnitureMixed:n}=q(e),i="#shipping-data";t?$(`${i}:not(.has-tv)`).addClass("has-tv"):$(`${i}.has-tv`).removeClass("has-tv"),s?$(`${i}:not(.has-rica)`).addClass("has-rica"):$(`${i}.has-rica`).removeClass("has-rica"),n?$(`${i}:not(.has-furniture-mixed)`).addClass("has-furniture-mixed"):$(`${i}.has-furniture-mixed`).removeClass("has-furniture-mixed")},ge=(e=[])=>{if($("#bash-delivery-error-container").length<1)return;const t=e.length>0?e.map((e=>(({text:e,fields:t})=>{if(!t.itemIndex)return"";const s=window.vtexjs.checkout?.orderForm.items?.[t.itemIndex];if(!s)return"";const n=s?.imageUrl;return` \n<div id="bash-delivery-error" class="notification error" alt="${t?.skuName??""}" >\n   \x3c!---<div class="icon"></div>---\x3e\n   ${n?`<img src="${n}" style=" float: right; " />`:""}\n   <div class="notification-content">\n      <h3>Address error ${t?.skuName?`- ${t?.skuName}`:""}</h3>\n      <p>${e}</p>\n      <p>Check the postal code of your address, or \n      <a href="#" \n        class="remove-cart-item"\n        style="color: white; text-decoration: underline"\n        data-index="${t.itemIndex}">remove this item from your cart</a>.\n      </p>\n   </div>  \n</div>  \n`})(e))):"";$("#bash-delivery-error-container").html(t),e.length>0&&$("html, body").animate({scrollTop:$("#bash-delivery-error-container").offset().top},400)},be=({eventCategory:e="Checkout_UserErrors",action:t="",label:s="",description:n="",value:i})=>{const r=()=>{window.dataLayer.push({event:"gaEvent",eventCategory:e,eventLabel:s,eventAction:t,eventValue:i,eventDescription:n})};if(!window.dataLayer)return $(window).off("gtm.load"),void $(window).on("gtm.load",r);r()},ye=(()=>{const s={inCollect:!1,pickupSelected:!1,validForm:!1,runningObserver:!1,collectReset:!1},o=()=>{$(".shp-alert.vtex-omnishipping-1-x-warning").remove(),$(".pickup-marker-blue").remove(),$("#change-pickup-button").length&&($('<button class="vtex-omnishipping-1-x-pickupPointSeeMore button-see-pickup-point btn btn-link" id="tfg-pickup-see-more-button" type="button">Collect Point Details</button>').appendTo(".vtex-omnishipping-1-x-PickupPoint"),$('<button class="vtex-change-pickup button-change-pickup-point" id="tfg-pickup-button" type="button">Change</button>').appendTo(".vtex-omnishipping-1-x-PickupPoint"),$("#change-pickup-button").remove(),$("#details-pickup-button").remove()),$(".vtex-omnishipping-1-x-ask").length&&($(".vtex-omnishipping-1-x-ask").empty(),$('<div class="pickup-map-container">\n          <div class="pickup-map-icon">\n            <svg class="icon-map" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48" fill="none">\n              <rect width="48" height="48" rx="24" fill="#2424E4"/>\n              <path d="M24.2147 11C21.5065 11.0031 18.9102 12.0802 16.9952 13.9952C15.0802 15.9102 14.0031 18.5065 14 21.2147C14 29.9552 23.2861 36.5599 23.6807 36.8385C23.8389 36.9438 24.0247 37 24.2147 37C24.4047 37 24.5905 36.9438 24.7486 36.8385C25.1433 36.5599 34.4294 29.9552 34.4294 21.2147C34.4263 18.5065 33.3491 15.9102 31.4342 13.9952C29.5192 12.0802 26.9228 11.0031 24.2147 11ZM24.2147 17.5003C24.9493 17.5003 25.6675 17.7181 26.2783 18.1262C26.8891 18.5344 27.3652 19.1145 27.6464 19.7932C27.9275 20.472 28.0011 21.2188 27.8577 21.9393C27.7144 22.6599 27.3607 23.3217 26.8412 23.8412C26.3217 24.3607 25.6599 24.7144 24.9393 24.8577C24.2188 25.0011 23.472 24.9275 22.7932 24.6464C22.1145 24.3652 21.5344 23.8891 21.1262 23.2783C20.7181 22.6675 20.5003 21.9493 20.5003 21.2147C20.5003 20.2296 20.8916 19.2848 21.5882 18.5882C22.2848 17.8916 23.2296 17.5003 24.2147 17.5003Z" fill="#FCFCFC"/>\n            </svg>\n            Find nearby collect points\n            <div class="pickup-map-text">\n              Search for addresses that you frequently use and we’ll locate stores nearby.\n            </div>\n          </div>\n          <button class="pickup-map-geolocation" id="find-pickups-button-new" type="button">\n            <svg xmlns="http://www.w3.org/2000/svg" width="15" height="16" viewBox="0 0 15 16" fill="none">\n              <path d="M1.12954 2.34666L5.24985 14.2506C5.42563 14.7639 6.15688 14.7498 6.3186 14.2295L7.97798 8.84354C8.00302 8.75549 8.05054 8.67548 8.11588 8.61138C8.18122 8.54727 8.26213 8.50127 8.35063 8.47791L13.7295 6.81854C14.2499 6.65682 14.2639 5.92557 13.7506 5.74979L1.84672 1.62948C1.74671 1.59433 1.6388 1.58815 1.53542 1.61167C1.43205 1.63519 1.33743 1.68745 1.26247 1.76241C1.18751 1.83737 1.13525 1.93199 1.11173 2.03536C1.08822 2.13873 1.09439 2.24665 1.12954 2.34666V2.34666Z" stroke="#2424E4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n            </svg>\n            Use my current location\n          </button>\n          <button class="pickup-map-manual" id="find-pickups-manually-search">\n            Manually search for an address\n          </button>\n        </div>').appendTo(".vtex-omnishipping-1-x-ask")),$("#pkpmodal-close").unbind().click((()=>{$("#tfg-pickup-map").remove()}));const e=function(e){$('<div class="tfg-pickup-map" id="tfg-pickup-map"><div class="tfg-pickup-map-content"></div></div>').appendTo($("body")),$("body").css("position","fixed"),$("body").css("width","100%");const t=document.createElement("iframe");t.src="https://pickup-map.bashconnect.com/",t.width="100%",t.height="100%",t.id="map",t.allow="geolocation",$(t).appendTo(".tfg-pickup-map-content"),window.Penpal.connectToChild({iframe:t,methods:{sendAttachment:e=>{ae(),window.vtexjs.checkout.sendAttachment("shippingData",e),$("#tfg-pickup-map").remove(),$("body").css("overflow","auto"),$("body").css("width","auto"),$("body").css("position","relative")},getCheckoutJS:()=>window.vtexjs.checkout.orderForm,getSpecialFields:()=>q(window.vtexjs.checkout.orderForm.items),remove:()=>{$("#tfg-pickup-map").remove(),$("body").css("overflow","auto"),$("body").css("width","auto"),$("body").css("position","relative")},getState:()=>e}}),$("#tfg-pickup-map").click((e=>{e.stopPropagation(),$("#tfg-pickup-map").remove(),$("body").css("overflow","auto"),$("body").css("width","auto"),$("body").css("position","relative")}))};$("#tfg-pickup-button").unbind().click((()=>e("none"))),$("#tfg-pickup-see-more-button").unbind().click((()=>e(r))),$("#find-pickups-button-new").unbind().click((()=>e("geolocate"))),$("#find-pickups-manually-search").unbind().click((()=>e("manual")))},a=()=>{if($("span.help.error").remove(),s.validForm=!0,["pickup-receiver","custom-pickup-complement"].forEach((e=>{let t,n=!0;switch(e){case"pickup-receiver":n=!($(`#${e}`).length>0&&!$(`#${e}`).attr("disabled")&&!$(`#${e}`).val()),t=".shp-pickup-receiver";break;case"custom-pickup-complement":n=!!(i=$(`#${e}`).val())&&("0"===(i=i.replace(/\s/g,""))[0]?i.match(/[0-9\s]{10}/):i.match(/[0-9\s]{9,}/)),t="#box-pickup-complement"}var i;n?$(t).removeClass("error"):($(t).addClass("error"),$(t).append('<span class="help error">This field is required.</span>'),$(`${t} span.error`).show(),Y(),s.validForm=!1)})),s.validForm){let e=$("#custom-pickup-complement").val().replace(/\s/g,"");9===e.length&&"0"!==e[0]&&(e=`0${e}`),localStorage.setItem("saving-shipping-collect",!0),$("#btn-go-to-payment").trigger("click");try{window.vtexjs.checkout.getOrderForm().then((t=>{const{address:s}=t.shippingData;return ee(d,{phone:e}).then((()=>{var t,n;t=s.receiverName,n=e,t&&n&&($(".vtex-omnishipping-1-x-SummaryItemAddress .collect-receiver").length?$(".collect-receiver").html(`${t} - ${n} `):$(".vtex-omnishipping-1-x-SummaryItemAddress").append(`<p class="collect-receiver">\n      ${t} - ${n}\n      </p>`))})),window.vtexjs.checkout.calculateShipping(s)})).done((()=>{localStorage.removeItem("saving-shipping-collect")}))}catch(e){console.error("VTEX_ORDERFORM_ERROR: Could not load at CollectController",e),be({eventCategory:"Checkout_SystemError",action:"OrderFormFailed",label:"Could not getOrderForm() from vtex",description:"Could not load orderForm for Collect."})}}},c=()=>{const c=$("#postalCode-finished-loading").length>0;$("#shipping-option-pickup-in-point").one("click",(()=>{s.collectReset=!0})),window.location.hash===t&&c?(s.inCollect=$("#shipping-option-pickup-in-point").hasClass("shp-method-option-active"),s.pickupSelected=0===$("div.ask-for-geolocation").length,s.inCollect&&(($("#tfg-pickup-button").length||$("#tfg-pickup-see-more-button").length)&&($("#find-pickups-manually-search").length||$("#find-pickups-button-new").length)||o(),V(),s.pickupSelected&&!s.collectReset?($("button.shp-pickup-receiver__btn").trigger("click"),$("div.shp-pickup-receiver").addClass("show"),$("p#box-pickup-complement").addClass("show"),(()=>{const t=te(r),s=O({type:"collect",fields:t});0===$("#custom-pickup-complement").length&&$(".btn-go-to-payment-wrapper").before(e),s&&$("#custom-pickup-complement").val(s),(()=>{const e=ce({preferred:window?.vtexjs?.checkout?.orderForm?.shippingData?.address?.receiverName,type:"collect"}).trim();console.info("prePopulateReceiverName",{receiverName:e}),$("#pickup-receiver").val(e.trim())})()})(),(()=>{if($("#custom-go-to-payment").length<=0){const e=$("#btn-go-to-payment"),t=e.clone(!1);$(e).hide(),$(t).data("bind",""),$(t).removeAttr("id").attr("id","custom-go-to-payment"),$(t).removeAttr("data-bind"),$(t).css("display","block"),$("p.btn-go-to-payment-wrapper").append(t),$(t).on("click",a)}})()):($("div.shp-pickup-receiver").removeClass("show"),$("p#box-pickup-complement").removeClass("show")),s.collectReset&&((()=>{$(".delivery-group-content").empty(),$(".btn-go-to-payment-wrapper").empty(),$('<div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z" opacity=".25" stroke="#FCFCFC" fill="#FCFCFC"/><path d="M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z" stroke="#000" fill="#000"><animateTransform attributeName="transform" type="rotate" dur="0.75s" values="0 12 12;360 12 12" repeatCount="indefinite"/></path></svg><div>').css({display:"flex","justify-content":"center","align-items":"center","min-height":"100px"}).appendTo(".delivery-group-content");const{orderForm:e}=window.vtexjs.checkout,{shippingData:t}=e,s={...t,address:null,availableAddresses:t.availableAddresses,selectedAddresses:t.selectedAddresses.filter((e=>"search"!==e.addressType)),logisticsInfo:t.logisticsInfo};window.vtexjs.checkout.sendAttachment("shippingData",s),ae(),o()})(),s.collectReset=!1),$("p.vtex-omnishipping-1-x-shippingSectionTitle").text("Collect options"),$("#change-pickup-button").text("Available pickup points"),$("h2.vtex-omnishipping-1-x-geolocationTitle.ask-for-geolocation-title").text("Find nearby Click & Collect points"),$("h3.vtex-omnishipping-1-x-subtitle.ask-for-geolocation-subtitle").text("Search for addresses that you frequently use and we'll locate stores nearby."),s.pickupSelected&&$("label.shp-pickup-receiver__label").text("Recipient's name")),localStorage.getItem("shipping-incomplete-values")&&($("#custom-go-to-payment").trigger("click"),localStorage.removeItem("shipping-incomplete-values"))):($("#box-pickup-complement").remove(),window.location.hash===n&&setTimeout((()=>{const e=window.vtexjs.checkout.orderForm?.shippingData?.address;if(!localStorage.getItem("saving-shipping-collect")){const{phone:s}=te(d);!e||e.addressType!==i||e.receiverName&&s||(window.location.hash=t,localStorage.setItem("shipping-incomplete-values",!0),be({action:"stepRedirect",label:"redirectPaymentToShipping",description:"User redirect to shipping because Collection is missing receiverName or phone number."}))}}),1e3)),l()},l=()=>{if(s.runningObserver)return;const e=document.querySelector(".shipping-container .box-step"),t=new MutationObserver((()=>{s.runningObserver=!0,c()}));e&&t.observe(e,{attributes:!1,childList:!0,characterData:!1})};return $(document).ready((()=>{c()})),$(window).on("hashchange orderFormUpdated.vtex",(()=>{c()})),{state:s,init:()=>{}}})(),fe=()=>((async()=>{const e=await H.getAddresses();if(e.length>0)return{data:e};const{email:t}=window?.vtexjs?.checkout?.orderForm?.clientProfileData,s=["id","addressType","addressQuery","addressName","reference","number","geolocation","receiverName","receiverPhone","complement","street","businessName","companyBuilding","neighborhood","city","postalCode","state","country","tvID","geoCoordinate"].join(","),n={headers:M({cookie:!0,cache:!0,json:!1}),credentials:"include"},i=Date.now();return fetch(`${c}masterdata/addresses?t=${i}&_fields=${s}&_where=${encodeURIComponent(`userIdQuery=${t}`)}`,n).then((e=>e.json())).then((async e=>(e.data&&H.loadAddresses(e.data),e))).catch((e=>L(`GET_ADDRESSES_ERROR: ${e?.message}`)))})().then((({data:e})=>{const t=e.map((e=>J(e)));document.getElementById("bash-address-list")&&(document.getElementById("bash-address-list").innerHTML=t.join("")),$("#back-button-select-address").hasClass("inactive")&&$("#back-button-select-address").show(),V(),e.length<1&&(window.postMessage({action:"setDeliveryView",view:"address-search"}),$("#bash--input-address-search").focus(),$("#back-button-select-address").hide(),$("#back-button-select-address").addClass("inactive"))})).catch((e=>{throw console.error("ERROR getAddresses",e),new Error("Error getAddresses",e.message)})),'\n <div class="bash--addresses shimmer" id="bash-address-list">\n    Loading addresses...\n  </div>\n  '),_e=({label:e,name:t,value:s="",required:n=!0,type:i="text",placeholder:r,autoComplete:o="on",maxLength:a,minlength:d,disabled:c=!1,options:l,checked:u,error:h="This field is required."})=>{const p=t.replace(/\s/g,"-"),m=`<label id="bash--label-${p}" for="bash--input-${p}">${e}</label>`;return`\n<p class="input bash--${i}field-${t.replace(/\s/g,"-")} bash--${i} ${n?"required":"optional"}">\n  ${e&&"checkbox"!==i?m:""}\n  ${(()=>{switch(i){case"radio":return G({name:t,options:l});case"dropdown":return(({name:e,disabled:t=!1,options:s,required:n})=>{const i=s.find((e=>!0===e.selected));return`\n  <select \n    name="${e}" \n    ${n?" required ":""} \n    ${t?" disabled ":""} \n    id="bash--input-${e}" \n    class="input-large" \n  >\n  ${s.map((({value:e,label:t,selected:s},n)=>`\n    <option \n    ${0===n?" disabled ":""}\n    ${0!==n||i?"":" selected "}\n    ${s?" selected ":""}\n      value="${e}" \n    >${t}</option>\n    `)).join("")}\n  </select>\n  `})({name:t,disabled:c,options:l,required:n});case"note":return(({value:e,name:t})=>`\n  <div class="bash--note-field ${t}">\n  ${e}\n  </div>\n  `)({name:t,value:s});case"checkbox":return(({name:e,label:t,checked:s,value:n})=>`\n    <label class="tfg-checkbox-label">\n       <input \n        type='checkbox' \n        name="${e}" \n        id="bash--input-${e}"\n        ${s?"checked='checked'":""}\n        value=${n??""}\n      />\n      <span>${t}</span>\n    </label>\n  `)({name:t,label:e,checked:u});default:return(({name:e,value:t="",required:s=!0,type:n="text",placeholder:i,autoComplete:r="on",minLength:o=0,maxLength:a=0})=>`\n  <input \n    ${s?" required ":""}\n    autocomplete="${r}" \n    id="bash--input-${e.replace(/\s/g,"-")}" \n    type="${n}" \n    name="${e}" \n    ${o>0?`minlength="${o}"`:""}\n    ${a>0?`maxlength="${a}"`:""}\n    placeholder="${i??""}" \n    class="input-xlarge" \n    value="${t}" \n  />\n`)({name:t,value:s,required:n,type:i,placeholder:r,autoComplete:o,maxLength:a,minlength:d})}})()}\n  <span class="bash--field-error">${h}</span>\n</p>  \n`},we=()=>(setTimeout((()=>{(()=>{if(!window.google)return;const e=document.getElementById("bash--input-address-search");if(!e)return;const t=new window.google.maps.places.Autocomplete(e,{componentRestrictions:{country:"ZA"}});window.google.maps.event.addListener(t,"place_changed",(()=>{const s=t.getPlace(),{address_components:n,geometry:i}=s;(e=>{const{street:t,neighborhood:s,postalCode:n,state:i,city:r,lat:o,lng:a}=e;document.getElementById("bash--address-form").reset(),document.getElementById("bash--input-addressId").value="",document.getElementById("bash--input-addressName").value="",document.getElementById("bash--input-number").value="  ",document.getElementById("bash--input-street").value=t??"",document.getElementById("bash--input-neighborhood").value=s??"",document.getElementById("bash--input-city").value=r??"",document.getElementById("bash--input-postalCode").value=n??"",document.getElementById("bash--input-state").value=de(i),document.getElementById("bash--input-lat").value=o||"",document.getElementById("bash--input-lng").value=a||"",$(":invalid").trigger("change")})(((e,t)=>{if(!e||e.length<1)return{};const s=e.find((e=>e.types.includes("street_number")))?.long_name,n=e.find((e=>e.types.includes("route")))?.long_name,i=e.find((e=>e.types.includes("sublocality")))?.long_name,r=e.find((e=>e.types.includes("locality")))?.long_name,o=e.find((e=>e.types.includes("postal_code")))?.long_name,a=e.find((e=>e.types.includes("administrative_area_level_1")))?.long_name,d={lat:"",lng:""};return t&&(d.lat=t.location.lat(),d.lng=t.location.lng()),{street:`${s??""} ${n??""}`.trim(),neighborhood:i,city:r,postalCode:o,state:a,...d}})(n,i)),window.postMessage({action:"setDeliveryView",view:"address-form"}),e.value=""})),e?.addEventListener("keyup",ue)})()}),500),`\n  \n  ${_e({name:"address-search",placeholder:"Start typing an address...",autoComplete:"off"})}\n    <div id="no-address-search-results-notification" class="notification info" >\n      <span class="icon"></span>\n      <div class="notification-content">\n      We could not find your address. \n        <a class="no-results-drop-down" href="" data-view="address-form" id="no-address-search-results">\n          Please click here to enter it manually.\n        </a>\n    </div>\n  `),$e=({hasFurn:e,hasFurnOnly:t,hasFurnMixed:s})=>`\n  <div class="bash--delivery-container ${e&&"has-furniture"}"\n   id="bash--delivery-container" data-view="select-address">\n    <div id="bash--shipping-messages">\n      <div id="bash-alert-container"></div>\n      \n  <div id="tfg-custom-tvrica-msg" class="tfg-custom-msg">\n    <p class="tfg-custom-icon"></p>\n    <p class="tfg-custom-text">\n      You can't collect this order in store because your cart contains items \n      which require either RICA or TV License validation.\n    </p>\n  </div>\n\n      \n  <div id="tfg-custom-mixed-msg" class="tfg-custom-msg">\n    <p class="tfg-custom-icon"></p>\n    <p class="tfg-custom-text">\n      We'll ship your furniture and other items in your cart to the selected address. \n      Only the furniture delivery fee will apply for your whole order.\n      </p>\n  </div>\n\n       \n \n<div id="bash-delivery-error-container"   >\n</div>\n    </div>\n   <form id="bash--delivery-form" name="bash--delivery-form" method="post">\n\n    <section class="bash--delivery-view" data-section="select-address">\n    <div class="bash--heading">\n        <h2>Delivery address</h2>\n        <a href="#" data-view="address-search">Add address</a>\n      </div>\n      ${fe()}\n    </section>\n\n    <section id="bash-delivery-options" class="shipping-method bash--delivery-view" data-section="select-address">\n      <hr>\n      <div class="bash--heading sub-heading">\n        <h3>Delivery method</h3>\n        ${t||s?'\n<a \n  href="http://image.tfgmedia.co.za/image/1/process/500x790?source=http://cdn.tfgmedia.co.za/15/Marketing/HTMLPages/Furniture_Delivery_Fees_tab_image.jpg"\n  class="furniture-fees-link" \n  target="_blank"\n>\n  Furniture delivery costs\n</a>\n':""}\n      </div>\n      ${(({hasFurnOnly:e,hasFurnitureMixed:t})=>{let s="Delivery within 3 - 5 working days";return t&&(s="Delivery within 3 - 10 working days"),e&&(s="Delivery within 5 - 10 working days"),$(".shp-summary-package-time > span").html(s),`\n  <label class="bash--delivery-option-display" >\n  ${G({name:"delivery-option",options:[{checked:!0,value:!0}]})}\n   \n   <div id="bash--delivery-option-text" class="bash--delivery-option-text">\n      <span class="normal-delivery">\n        ${s}\n      </span>\n   </div>\n\n  <div id="bash--delivery-fee" class="bash--delivery-fee">\n    R50\n  </div>\n</label>\n\n\n  <div class="furniture-delivery-notes">\n\n    <div id="furniture-delivery-mixed" class="furniture-note">\n      <h4>Only furniture delivery fees apply</h4>\n      <p>\n        We’ll ship your furniture and other items in your cart to the selected address. \n        Only the furniture delivery fee will apply for your whole order.\n      </p>\n      <p>We’ll call the recipient in the next few days to arrange the furniture delivery.</p>\n      <p>Note: Our couriers can’t hoist goods.</p>\n    </div>\n\n    <div id="furniture-delivery-only" class="furniture-note">\n      <h4>Furniture delivery</h4>\n      <p> We’ll call the recipient in the next few days to arrange the furniture delivery.</p>\n      <p>Note: Our couriers can’t hoist goods.</p>\n    </div>\n    \n  </div>\n  \n  `})({hasFurnOnly:t,hasFurnitureMixed:s})}\n      <button \n        class="submit btn-go-to-payment btn btn-large btn-success"\n        id="btn-save-delivery" \n        type="submit">\n          Go to payment\n      </button>\n    </section>\n   </form>\n\n    <section class="bash--delivery-view" data-section="address-search">\n      <div class="bash--heading">\n        <h3>Add a new delivery address</h3>\n        <a href='#' data-view='select-address' id='back-button-select-address'>&lt; Back</a>\n      </div>\n      <div class="address-search-field-container" id="address-search-field-container">\n          ${we()} \n      </div>\n      <p style="font-size: 12px; margin: 16px 0" id="type-your-address-above">\n        Type your address above or \n        <a \n          href="" id="link-manual-address-entry"\n          data-view="address-form"\n          onClick="document.getElementById('bash--input-street').focus()"\n          style="text-decoration: underline" \n        >enter it manually</a>.\n      </p>\n    </section>\n    \n    <section class="bash--delivery-view" data-section="address-form">\n       <div class="bash--heading">\n        <h3>Delivery address</h3>\n        <a href="#" class="back-button--search" data-view="address-search">&lt; Back</a>\n        <a href="#" class="back-button--select" data-view="select-address">&lt; Back</a>\n      </div>\n      \n  <form id="bash--address-form" method="post">\n    ${[{name:"addressId",type:"hidden",value:"",required:!1},{name:"addressName",type:"hidden",value:"",required:!1,maxLength:50},{name:"lat",required:!1,type:"hidden",value:""},{name:"lng",required:!1,type:"hidden",value:""},{name:"street",label:"Street address",required:!0,value:""},{name:"addressType",label:"Address type",required:!0,type:"radio",options:[{value:"residential",label:"Residential",checked:!0},{value:"business",label:"Business"}]},{name:"number",required:!1,value:"",type:"hidden"},{name:"businessName",label:"Business name",required:!1,value:"",maxLength:100},{name:"companyBuilding",label:"Building/Complex and number",required:!1,value:"",maxLength:100},{name:"neighborhood",label:"Suburb",value:"",maxLength:750},{name:"city",label:"City",required:!0,value:"",maxLength:750},{name:"postalCode",label:"Postal code",value:"",type:"tel",minlength:4,maxLength:4},{type:"note",required:!1,name:"suburb-postal-reminder",value:"Make sure to specify the correct Suburb and Postal code so we can easily find your address."},{name:"state",label:"Province",type:"dropdown",options:[{value:"",label:"Select"},{value:"EC",label:"Eastern Cape"},{value:"FS",label:"Free State"},{value:"GP",label:"Gauteng"},{value:"KZN",label:"KwaZulu-Natal"},{value:"LP",label:"Limpopo"},{value:"MP",label:"Mpumalanga"},{value:"NC",label:"Northern Cape"},{value:"NW",label:"North West"},{value:"WC",label:"Western Cape"}]},{type:"note",required:!1,name:"country-display",label:"Country",value:"South Africa"},{type:"hidden",required:!0,name:"country",value:"ZAF"},{name:"receiverName",label:"Recipient’s name",required:!0,value:ce({type:"delivery"})},{name:"complement",required:!1,type:"hidden",helperText:"We send shipping updates to this number.",value:""},{name:"receiverPhone",label:"Recipient’s mobile number",required:!0,type:"tel",helperText:"We send shipping updates to this number."}].map((e=>_e(e))).join("")}\n\n    <button \n      class="submit btn-go-to-payment btn btn-large btn-success"\n      id="btn-save-address" \n      type="submit">\n      Save address\n    </button>\n  </form>\n  \n  \n    </section>\n    \n  </div>`,xe=({hasTV:e,hasSim:t})=>{const s=`\n    <div id="tv-license-form">\n      <hr>\n      <div class="bash--heading sub-heading heading-with-description">\n        <h3>TV license information needed</h3>\n        <p class="tfg-custom-subtitle">Please provide your ID number to validate your TV Licence.</p>\n      </div>\n      \n    ${_e({name:"tv_tvID",label:"SA ID number",required:!0,value:""})}\n  \n    </div>\n  `,n=`\n    <div id="rica-form">\n      <hr>\n      <div class="bash--heading sub-heading heading-with-description">\n        <h3>Rica information required</h3>\n        <p class="tfg-custom-subtitle">\n          To RICA your SIM card, provide your SA ID (or foreign passport) number and your address as\n          it appears on a valid proof of residence.\n        </p> \n      </div>\n        ${(()=>{const{shippingData:{selectedAddress:e}}=window.vtexjs.checkout.orderForm,t=[{name:"rica_fullName",label:"Full name and surname",required:!0,value:ce({type:"delivery"})||""},{name:"rica_streetAddress",label:"Street address",required:!0,value:e?.street||""},{name:"rica_suburb",label:"Suburb",value:e?.neighborhood||""},{name:"rica_city",label:"City",required:!0,value:e?.city||""},{name:"rica_postalCode",label:"Postal code",value:e?.postalCode||"",type:"tel",minlength:4,maxLength:4},{name:"rica_province",label:"Province",type:"dropdown",options:[{value:"",label:"Select",disabled:!0},{value:"EC",label:"Eastern Cape"},{value:"FS",label:"Free State"},{value:"GP",label:"Gauteng"},{value:"KZN",label:"KwaZulu-Natal"},{value:"LP",label:"Limpopo"},{value:"MP",label:"Mpumalanga"},{value:"NC",label:"Northern Cape"},{value:"NW",label:"North West"},{value:"WC",label:"Western Cape"}]},{type:"note",required:!1,name:"rica-country-display",label:"Country",value:"South Africa"},{type:"hidden",required:!0,name:"country",value:"ZAF"}];return`\n    ${[{name:"rica_idOrPassport",label:"ID or Passport number",required:!0,value:""},{name:"rica_sameAddress",label:"Residential address the same as delivery address",type:"checkbox",checked:!0,required:!1}].map((e=>_e(e))).join("")}\n    <div class="rica-conditional-fields hide">\n    ${t.map((e=>_e(e))).join("")}\n    </div>\n  `})()}\n    </div>\n    `;return`\n  <section class="bash--extra-fields bash--delivery-view" data-section="select-address">\n    ${e?s:""}\n    ${t?n:""}\n  </section>`},ke=(e,t={validateExtraFields:!0})=>{console.info("### setAddress ###",{address:e});const{validateExtraFields:s}=t,{items:n}=window.vtexjs.checkout.orderForm,{hasTVs:i,hasSimCards:r}=q(n);i&&he(e,ie,"tv_"),r&&pe();const{isValid:o,invalidFields:a}=me(e,s);if(!o)return console.error({invalidFields:a}),le(e),$("#bash--address-form").addClass("show-form-errors"),s&&$("#bash--delivery-form")?.addClass("show-form-errors"),$(`#bash--input-${a[0]}`).focus(),se.includes(a[0])&&window.postMessage({action:"setDeliveryView",view:"address-edit"}),{success:!1,error:"Invalid address details."};"business"===e.addressType&&(e.addressType="commercial"),re.includes(e.addressType)||(e.addressType="residential"),e.number&&(e.street=`${e.number} ${e.street}`,e.number=""),e.country="ZAF";const{shippingData:d}=window?.vtexjs?.checkout?.orderForm;return d.address=e,d.selectedAddresses=[e],e.complement&&(e.receiverPhone=e.complement,d.address.complement="",e.complement=""),e.companyBuilding&&!d.address.street.includes(`, ${e.companyBuilding}`)&&(d.address.street=`${e.street}, ${e.companyBuilding}`),d.selectedAddresses[0]=d.address,oe(),window.vtexjs.checkout.sendAttachment("shippingData",d).then((t=>{const{messages:s}=t,n=s.filter((e=>"error"===e.status));if(n.length>0)return ge(n),window.postMessage({action:"setDeliveryView",view:"address-form"}),{success:!1,errors:n};e.addressName&&K(e),console.info("### Update customData ###",{address:e});try{(({businessName:e,receiverPhone:t})=>{ee("deliver",{jsonString:JSON.stringify({businessName:e||"",receiverPhone:t||""})})})({businessName:e.businessName,receiverPhone:e.receiverPhone})}catch(e){be({eventCategory:"Checkout_SystemError",action:"OrderFormFailed",label:"Could not update businessName and/or receiverPhone ",description:"Could not update businessName and/or receiverPhone."})}return{success:!0}})).done((()=>V()))},Se=async e=>{e.preventDefault(),$("select").change();const t=document.forms["bash--address-form"],s=$("#bash--input-addressName").val(),n=["addressId","addressName","addressType","receiverName","receiverPhone","postalCode","city","state","country","businessName","street","neighborhood","complement","companyBuilding","lat","lng"],i={isDisposable:!1,reference:null,geoCoordinates:[],country:"ZAF",...await Q(s),number:"",complement:""};for(let e=0;e<n.length;e++)i[n[e]]=t[n[e]]?.value||null;i.addressName=i.addressName||i.addressId,i.addressId=i.addressId||i.addressName,i.geoCoordinate=[parseFloat(i.lat)||"",parseFloat(i.lng)||""],i.geoCoordinates=[parseFloat(i.lat)||"",parseFloat(i.lng)||""],console.info("### submitAddressForm @@##",{address:i,fields:n});const r=i,{isValid:o,invalidFields:a}=me(i,!1);if(!o)return console.error({invalidFields:a}),$("#bash--address-form").addClass("show-form-errors"),$(`#bash--input-${a[0]}`).focus(),void(se.includes(a[0])&&window.postMessage({action:"setDeliveryView",view:"address-form"}));const d=await ke(r,{validateExtraFields:!1}),{success:c}=d;c?(await z(i),window.postMessage({action:"setDeliveryView",view:"select-address"}),setTimeout((()=>{$(".bash--extra-fields").length>0?document.querySelector(".bash--extra-fields").scrollIntoView({behavior:"smooth"}):document.getElementById("bash-delivery-options").scrollIntoView({behavior:"smooth"})}),500),(()=>{$(".alert-container").addClass("show"),$(".alert-container").slideDown();const e=$('[data-view="address-form"]').length>0?"Address added":"Address updated";$("#bash-alert-container").html((({text:e})=>`<div class='alert-container'>\n      <p>${e}</p>\n    </div>\n  `)({text:e})),setTimeout((()=>{$(".alert-container").slideUp()}),5e3)})()):console.error("Set address error",{setAddressResponse:d})},Ce=async e=>{e.preventDefault();const{items:t}=window.vtexjs.checkout.orderForm,{address:s}=window.vtexjs.checkout.orderForm.shippingData,{hasTVs:i,hasSimCards:r}=q(t);$("select").change();let d={};const c="[name='selected-address']:checked";if($(c).length<1)return void $("html, body").animate({scrollTop:$("#bash--delivery-form").offset().top},400);oe();const l=await Q($(c).val());d={...s,...l};const{success:u}=await ke(d,{validateExtraFields:!1});if(!u)return console.error("Delivery Form - Address Validation error"),void V();const h={},p={};if(r){const e=ne;for(let t=0;t<e.length;t++){if("sameAddress"===e[t]){const s=$(`#bash--input-${e[t]}`).is(":checked");h[e[t]]=s}h[e[t]]=$(`#bash--input-rica_${e[t]}`).val()||""}const t=await ee(o,h,!0);console.info({ricaDataSent:t})}if(i){const e=ie;for(let t=0;t<e.length;t++)s[e[t]]||(d[e[t]]=$(`#bash--input-tv_${e[t]}`).val()),p[e[t]]=$(`#bash--input-tv_${e[t]}`).val()||"";const t=await ee(a,p);console.info({tvDataSent:t})}await z(d),$(".bash--delivery-container").css("display","none"),window.location.hash=n,V()},Ee=(()=>{const e={view:"list",hasFurn:!1,hasTVs:!1,hasSim:!1,hasFurnMixed:!1,hasFurnOnly:!1},s=()=>{if(window.location.hash===t&&$(".shipping-summary-info").length&&"Waiting for more information"===$(".shipping-summary-info").text()&&(window.location.hash="#/profile",be({action:"stepRedirect",label:"redirectShippingToProfile",description:'User redirect to profile - "Waiting for more information" error.'})),!$("#bash--delivery-container").length){if(window.vtexjs.checkout.orderForm){const t=window.vtexjs.checkout.orderForm?.items,{hasFurniture:s,hasTVs:n,hasSimCards:i,hasFurnitureMixed:r,hasFurnitureOnly:o}=q(t);e.hasFurn=s,e.hasTVs=n,e.hasSim=i,e.hasFurnOnly=o,e.hasFurnMixed=r}$(".shipping-data .box-step").append($e({hasFurnOnly:e.hasFurnOnly,hasFurnMixed:e.hasFurnMixed})),e.hasFurn?$("#shipping-data:not(.has-furniture)").addClass("has-furniture"):$("#shipping-data.has-furniture").removeClass("has-furniture"),(e.hasFurn||e.hasSim||e.hasTVs)&&($("#bash-delivery-options").before(xe({hasSim:e.hasSim,hasTV:e.hasTVs})),e.hasSim&&pe(),e.hasTVs&&(async()=>{const e=te(a);he(e,ie,"tv")})()),$("select, input").on("invalid",(function(){const e=this;$(e)[0].setCustomValidity(" "),$(e).parents("form").addClass("show-form-errors"),$(e).off("change keyUp"),$(e).on("change keyUp",(()=>{$(e)[0].setCustomValidity("")}))}))}};return $(window).unload((()=>{X()})),$(document).ready((()=>{X(),window.location.hash===t?(s(),$(".bash--delivery-container.hide").removeClass("hide"),$(".bash--delivery-container").css("display","flex")):$(".bash--delivery-container:not(.hide)").length&&($(".bash--delivery-container:not(.hide)").addClass("hide"),$(".bash--delivery-container").css("display","none"))})),$(window).on("hashchange",(()=>{console.info("hashchange TO SHIPPING"),window.location.hash===t?(setTimeout((()=>{console.info("SCROLL TO SHIPPING"),document.getElementById("shipping-data").scrollIntoView({behavior:"smooth"})}),500),s(),ve(),$(".bash--delivery-container").css("display","flex"),$(".bash--delivery-container.hide").removeClass("hide")):$(".bash--delivery-container:not(.hide)").length&&($(".bash--delivery-container:not(.hide)").addClass("hide"),$(".bash--delivery-container").css("display","none"))})),$(window).on("orderFormUpdated.vtex",(()=>{const e=window.vtexjs.checkout.orderForm?.items,r=window.vtexjs.checkout.orderForm.shippingData?.address?.addressType,{hasTVs:d,hasSimCards:c,hasFurnitureMixed:l}=q(e),{messages:u}=window.vtexjs.checkout.orderForm;if(window.location.hash===t){const e=u.filter((e=>"error"===e.status));e&&ge(e)}if(r===i){if(d||c||l)return window.location.hash!==t&&(window.location.hash=t),void setTimeout((()=>document.getElementById("shipping-option-delivery")?.click()),2e3);$("#shipping-data:not(collection-active)").addClass("collection-active"),$(".delivery-active").removeClass("delivery-active")}else s(),$("#shipping-data:not(delivery-active)").addClass("delivery-active"),$(".collection-active").removeClass("collection-active");ve(),(()=>{if(!window.vtexjs.checkout.orderForm.totalizers)return;const{value:e}=window.vtexjs.checkout.orderForm.totalizers.find((e=>"Shipping"===e.id))||{value:5e3};let t="Free";e>0&&(t=`R${(e/100).toFixed(2).replace(".00","")}`),$("#bash--delivery-fee").length>0&&(document.getElementById("bash--delivery-fee").innerHTML=t)})(),window.location.hash!==n||(()=>{const e=window.vtexjs.checkout.orderForm?.items,{hasTVs:t,hasSimCards:s}=q(e);let n=!0;if(t&&(te(a).tvID||(n=!1)),s){const e=te(o);e.idOrPassport&&e.streetAddress&&e.postalCode||(n=!1)}return n})()||(Y(),window.location.hash=t,be({action:"stepRedirect",label:"redirectPaymentToShipping",description:"User redirect to shipping because Extra Fields are invalid."}))})),$(document).on("click","a[data-view]",(function(e){e.preventDefault();const t=$(this).data("view"),s=decodeURIComponent($(this).data("content"));window.postMessage({action:"setDeliveryView",view:t,content:s})})),$(document).on("click","#no-address-search-results",(()=>{document.getElementById("bash--address-form").reset(),document.getElementById("bash--input-street").focus()})),$(document).on("change",'input[type="radio"][name="selected-address"]',(function(){const e=(e=>{try{return JSON.parse(decodeURIComponent(e))}catch(e){return}})($(this).parents(".bash--address-listing").data("address"));document.forms["bash--delivery-form"]&&(document.forms["bash--delivery-form"].reset(),$("#bash--input-lat").val(""),$("#bash--input-lng").val(""),document.forms["bash--delivery-form"].classList.remove("show-form-errors")),e&&Q(e.addressName).then((t=>{ke(t||e,{validateExtraFields:!1}),$('input[type="radio"][name="selected-address"]:checked').attr("checked",!1),$(this).attr("checked",!0)})).catch((e=>{console.error("Could not get address - address selection",e?.message)}))})),$(document).on("change","#bash--input-rica_sameAddress",(function(){this.checked?$(".rica-conditional-fields").slideUp((()=>pe())):((()=>{const e=$("#bash--input-rica_idOrPassport").val();he({idOrPassport:e??"",fullName:"",streetAddress:"",suburb:"",city:"",postalCode:"",province:""},ne,"rica_",!0)})(),$(".rica-conditional-fields").slideDown((()=>$("#bash--input-rica_fullName").focus())))})),$(document).on("change",'input[name="addressType"]',(function(){$(this).is(":checked")&&("business"===$(this).val()?U({focus:!0}):W())})),$(document).on("click","#shipping-option-pickup-in-point, #shipping-option-delivery",(function(){"shipping-option-pickup-in-point"===$(this).attr("id")?$("#bash--delivery-container").hide():$("#bash--delivery-container").show()})),$(document).on("submit","#bash--address-form",Se),$(document).on("submit","#bash--delivery-form",Ce),$(document).on("click",".remove-cart-item",(function(e){var t;e.preventDefault(),(t=$(this).data("index"),window.vtexjs.checkout.updateItems([{index:`${t}`,quantity:0}]).done((()=>{V()}))).done((()=>{V()}))})),window.addEventListener("message",(e=>{const{data:t}=e;if(t&&t.action)switch(t.action){case"setDeliveryView":if(document.querySelector(".bash--delivery-container")?.setAttribute("data-view",t.view),("address-form"===t.view||"address-edit"===t.view)&&((e=>{const t=document.querySelector(e);if(!t)return;t.setAttribute("type","tel"),t.setAttribute("maxlength",12),t.value=P(t.value);const s=$(e);s.keyup((e=>{const t=e.currentTarget.value.replace(/[^0-9+*#]+/g,"").trim();let n=t;const i=8===e.keyCode;n=P(t,!i),s.parent(".text").removeClass("error"),s.parent(".text").find("span.error").hide(),s.val(n)}))})("#bash--input-receiverPhone"),t.content))try{const e=JSON.parse(decodeURIComponent($(`#${t.content}`).data("address")));le(e)}catch(e){console.warn("Could not parse address Json",t.content)}break;case"FB_LOG":break;default:console.error("Unknown action",t.action)}})),{state:e,init:()=>{}}})(),Fe=(()=>{const e={showFurnitureForm:!1,showTVIDForm:!1,showRICAForm:!1,showTVorRICAMsg:!1,showMixedProductsMsg:!1,runningObserver:!1},t=()=>{setTimeout((()=>{(()=>{if(window.vtexjs.checkout.orderForm){const{items:t}=window.vtexjs.checkout.orderForm,{hasTVs:s,hasSimCards:n,hasFurnitureMixed:i}=q(t);e.showTVIDForm=s,e.showRICAForm=n,e.showTVorRICAMsg=e.showTVIDForm||e.showRICAForm,e.showMixedProductsMsg=i}})(),e.showFurnitureForm?$("div.subheader").css("display","none"):$("div.subheader").css("display","block")}),500)};return $(document).ready((()=>{t()})),$(window).on("hashchange orderFormUpdated.vtex",(()=>{t()})),$(document).on("click","#shipping-data .btn-link.vtex-omnishipping-1-x-btnDelivery",(()=>{t()})),{state:e,setView:e=>{document?.body?.setAttribute("data-delivery-view",e)},showCustomSections:()=>{const t=$("#tfg-custom-tvrica-msg").length>0,s=$("#tfg-custom-mixed-msg").length>0;let n=!1;var i;(e.showTVorRICAMsg||e.showMixedProductsMsg)&&($(".vtex-omnishipping-1-x-deliveryChannelsWrapper.custom-disabled").length<1&&($("#shipping-option-delivery").trigger("click"),$(".vtex-omnishipping-1-x-deliveryChannelsWrapper").addClass("custom-disabled")),e.showTVorRICAMsg&&!t&&($(".vtex-omnishipping-1-x-addressFormPart1").prepend('\n  <div id="tfg-custom-tvrica-msg" class="tfg-custom-msg">\n    <p class="tfg-custom-icon"></p>\n    <p class="tfg-custom-text">\n      You can\'t collect this order in store because your cart contains items \n      which require either RICA or TV License validation.\n    </p>\n  </div>\n'),n=!0),e.showMixedProductsMsg&&!s&&($(".vtex-omnishipping-1-x-addressFormPart1").prepend('\n  <div id="tfg-custom-mixed-msg" class="tfg-custom-msg">\n    <p class="tfg-custom-icon"></p>\n    <p class="tfg-custom-text">\n      We\'ll ship your furniture and other items in your cart to the selected address. \n      Only the furniture delivery fee will apply for your whole order.\n      </p>\n  </div>\n'),n=!0)),n&&(i=".tfg-custom-step",$(i).addClass("custom-step-border"),$(i).last().addClass("last-custom-step-border"))},init:()=>{}}})(),Ne=document.createElement("script");Ne.setAttribute("src","https://unpkg.com/penpal@^6/dist/penpal.min.js"),document.head.appendChild(Ne),document.addEventListener("DOMContentLoaded",(async()=>{let e=window?.vtexjs?.checkout?.orderForm;try{e||(e=await window.vtexjs.checkout.getOrderForm()),e&&(Fe.init(),ye.init(),Ee.init())}catch(e){console.error("VTEX_ORDERFORM_ERROR: Could not load at custom-shipping-steps Entry Point",e),be({eventCategory:"Checkout_SystemError",action:"OrderFormFailed",label:"Could not getOrderForm() from vtex",description:"Could not load orderForm on custom-shipping-steps Entry Point"}),Fe.init(),ye.init(),Ee.init()}}))})()})();